# 第一篇 概述

## 第一章 计算机系统概论

#### 1.1 计算机系统简介

1. 计算机系统有“硬件”和“软件”两大部分组成
    1. 硬件：计算机的实体部分
    2. 软件：人们实现编制成具有各类特殊功能的信息组成。
        1. 软件分为：系统软件、应用软件。

2. 计算机层次结构![1583560486198](2020_Conputer_organization.assets/2020_Conputer_organization01.md)

3. 计算机组成和计算机体系结构

    1. 计算机组成

        ```
        如何实现计算机体系结构所体现的属性，它包含了许多对程序员来说是透明的硬件细节。
        ```

    2. 计算机体系结构

        ```
        能够被程序员所见到的计算机系统的属性，即概念性的结构和功能特性
        ```

#### 1.2 计算机的基本组成

1. 冯 · 诺依曼计算机（以运算器为中心）（实线为数据线，虚线为控制线和反馈线）![1583561032355](2020_Conputer_organization.assets/2020_Conputer_organization02.md)

2. 现代计算机以存储器为中心（实线为控制线，虚线为反馈线，双线为数据线）![1583561366331](2020_Conputer_organization.assets/2020_Conputer_organization03.md)

3. 图中各部件功能

    ```
    运算器：完成算术运算和逻辑运算，并将运算的中间结果暂存在运算器内。
    
    存储器：用来存放数据和程序。
    
    控制器用来控制、指挥程序和数据的输入、运行以及处理运算结果。
    
    输入设备：将信息转换为机器能识别的信息形式。
    输出设备：将运算结果转换为人们熟悉的信息形式。
    ```

4. 存储器的基本组成

    ```
    存储单元：存放一串二进制代码（每个存储单元赋予一个地址号）
    存储字：存储单元中二进制代码的组合
    存储字长：存储单元中二进制代码的位数
    ```

5. 现代计算机硬件框图![1583562109350](2020_Conputer_organization.assets/2020_Conputer_organization04.md)

    ![1583562281477](2020_Conputer_organization.assets/2020_Conputer_organization05.md)

6. 常见缩写

    ```
    CPU：中央处理器
    ALU：算术逻辑运算单元（简称算逻部件）
    CU：控制单元（用来解释存储器中的指令，并发出各种操作命令来执行指令）
    ACC：累加器
    MQ：乘商寄存器
    X：操作数寄存器
    MAR：存储器地址寄存器（存放欲访问的存储单元的地址）（位数对应存储单元的位数）
    MDR：存储器数据寄存器（存放从存储体某单元取出的代码或者准备往存储单元存入的代码）（位数与存储字长相等）
    PC：程序计数器（存放当前欲执行命令的地址）（具有计数功能PC + 1 -> PC）
    IR：指令寄存器（存放当前的指令）
    MIPS：每秒执行（2）百万条指令（即2MIPS）
    CPI：执行一条指令所需的时钟周期（主频的倒数）
    FLOPS：每秒浮点运算次数来衡量运算速度
    ```

#### 1.3 计算机硬件的主要技术指标

1. 机器字长

    ```
    指CPU一次能处理数据的位数，通常与CPU的寄存器位数有关。（字长越长，数的表示范围越大，精度越高）。
    ```

2. 存储器的容量（存储容量）（包括主存容量和辅存容量）

    ```
    主存容量：主存中存放二进制代码的总数。
    存储容量 = 存储单元个数 x 存储字长
    ```

3. 运算速度

    ```
    MIPS、CPI、FLOPS、吉普森法
    ```

#### 1.4 本书结构

1. ![1583563774460](2020_Conputer_organization.assets/2020_Conputer_organization06.md)

## 第二章 计算机的发展及应用

# 第二篇 计算机系统硬件结构

## 第三章 系统总线

#### 3.1 总线的基本概念

1. 计算机系统的五大部件之间的互连方式
    1. 分散连接：各部件之间通过单独的连线
    2. 总线连接：将各部件连到一组公共信息传输线上
2. 总线定义：连接各个部件的信息传输线，是各个部件共享的传输介质

3. 总线连接在某一时刻，只允许有一个部件向总线发送信息，多个部件可以同时从总线上接受相同的信息。

4. 以存储器为中心的双总线结构框图![1583565103327](2020_Conputer_organization.assets/2020_Conputer_organization07.md)

#### 3.2 总线的分类

1. 按数据传送方式分

    ```
    并行传输总线：按传输数据宽度又可分为8位、16位、32位等传输总线
    串行传输总线
    ```

2. 按总线的使用范围分

    ```
    计算机（包括外设）总线
    测控总线
    网络通信总线等
    ```

3. 按连接部件的不同分

    1. 片内总线：指芯片内部的总线。

        ```
        例如，CPU芯片内部，寄存器与寄存器之前、寄存器与算逻单元ALU之间都有总线连接。
        ```

    2. 系统总线：指CPU、主存、I/O（通过I/O接口）各大部件之间的信息传输线。（按传输信息的不同分为：数据总线、地址总线和控制总线三类。）

        1. 数据总线：

            ```
            用来传输各功能部件之间的数据信息，是双向传输总线，位数与机器字长、存储字长有关。
            
            数据总线的条数称为数据总线宽度。
            ```

        2. 地址总线

            ```
            用来指出数据总线上的源数据或目的数据在主存单元的地址，是单向传输的，位数与存储单元的个数有关。
            ```

        3. 控制总线

            ```
            用来发出各种控制信号的传输线。
            对于任一控制线而言，传输是单向的；对于控制总线整体来说，传输是双向的。
            控制信号有出有入。
            ```

    3. 通信总线：用于计算机系统之间或计算机系统与其他系统之间的通信。（按传输方式分为：串行通信总线和并行通信总线两种）

#### 3.3 总线特性及性能指标

1. 总线物理实现![1583567017320](2020_Conputer_organization.assets/2020_Conputer_organization08.md)

2. 总线特性

    1. 机械特性

        ```
        指总线在机械连接方式上的一些性能（尺寸、形状、管脚数、排列顺序等）
        ```

    2. 电气特性

        ```
        指总线的每一根传输线上信号的传递方向和有效的电平范围。
        ```

    3. 功能特性

        ```
        指总线中每根传输线的功能（地址总线指出地址号、数据总线传递数据、控制总线发出控制信号（既有CPU发出的，也有I/O向CPU发来的））
        ```

    4. 时间特性

        ```
        指总线中的任一根线在什么时间内有效。每条总线上的各种信号，互相存在着一种有效时序的关系，因此，时间特性一般可用信号时序图来描述。
        ```

3. 与总线传输速度相关的时间概念

    ![1583569761093](2020_Conputer_organization.assets/2020_Conputer_organization09.md)

    1. 总线的传输周期（也称总线周期）
    
        ```
    指一次总线操作所需要的时间，包括申请阶段、寻址阶段、传输阶段和结束阶段，通常由若干个总线时钟周期构成
        ```

    2. 总线的时钟周期（也称机器的时钟周期）
    
        ```
    计算机有一个统一的时钟，以控制整个计算机的各个部件有条不紊地进行工作。总线上信息传送也要受此时钟的控制。
        ```

    3. 总线的工作频率
    
        ```
    是指总线上各种操作的频率，为总线周期的倒数。若总线周期=N个时钟周期，则总线的工作频率=时钟频率/N，物理意义：一秒钟传送了几次数据。
        ```

    4. 总线的时钟频率
    
        ```
    给定的参数都是时钟频率，频率与周期是一种倒数关系。
        ```

4. 总线的性能指标

    1. 总线宽度

        ```
        指数据总线的根数，用bit表示，如8位、16位等（也即8根、16根）
        ```

    2. 标准传输率（总线带宽）

        ```
        总线上每秒能传输的最大字节量，用MB/s表示。如总线工作频率为33MHz，总线宽度为32位（4字节），则它最大传输率为132MB/s.
        ```

    3. 时钟同步/异步

        ```
        总线上的 数据与时钟同步工作的总线称同步总线，与时钟不同步工作的总线称异步总线。
        ```

    4. 总线复用

        ```
        通常地址总线与数据总线在物理上是分开的两种总线。地址总线传输地址码，数据总线传输数据信息。为了提高总线利用率，将地址总线和数据总线共用一组物理线路，某一时刻传输地址信号，另一时刻传输数据信号或命令信号。这叫做总线的多路复用。
        ```

    5. 信号线数

        ```
        即地址总线、数据总线和控制总线三种总线数的总和。
        ```

    6. 总线控制方式

        ```
        包括并发工作、自动配置、仲裁方式、逻辑方式、计算方式等。
        ```

    7. 其他指标

        ```
        如负载能力问题。
        ```

5. 总线标准：为了使系统设计简化，模块生产批量化，确保其性能稳定，质量可靠，实现可移化，便于维护等。

    ![1583920486248](2020_Conputer_organization.assets/2020_Conputer_organization10.md)
    
    ![1583920902774](2020_Conputer_organization.assets/2020_Conputer_organization11.md)

#### 3.4 总线结构

1. 单总线结构

    ![1583921057243](2020_Conputer_organization.assets/2020_Conputer_organization12.md)

    ```
    优点：结构简单，便于扩充。
    
    缺点：所有的传送都通过一组共享总线，极易形成计算机系统的瓶颈。也不允许两个以上的部件在同一时刻向总线传输信息，影响系统工作效率的提高。
    
    用途：大多为小型机或微型机采用。
    ```

2. 双总线结构（将速度较低的I/O设备从单总线上分离出来）![1583921475151](2020_Conputer_organization.assets/2020_Conputer_organization13.md)

    ```
    优点：系统的吞吐能力可以相当大。
    用途：大、中型计算机系统
    ```

3. 1 三总线结构①（将速率不同的I/O设备进行分类，并连在不同的通道上）![1583921719851](2020_Conputer_organization.assets/2020_Conputer_organization14.md)

    ```
    解释：主存总线用于CPU与主存之间的传输；I/O总线供CPU与各类I/O之间传递信息；DMA总线用于高速外设（磁盘、磁带等）与主存之间直接交换信息。
    注意：三总线结构中，任一时刻只能使用一种总线。主存总线与DMA总线不能同时对主存进行存取，I/O总线只有在执行I/O指令时才用到。
    ```

3. 2 三总线结构②（效率更高）![1583922028892](2020_Conputer_organization.assets/2020_Conputer_organization15.md)

4. 四总线结构（进一步提高I/O性能）![1583922471372](2020_Conputer_organization.assets/2020_Conputer_organization16.md)

#### 3.5 总线控制

（一）、总线判优控制

```
主设备：对总线有控制权
从设备：只能响应主设备发来的总线命令
总线仲裁：为了解决多个主设备同时竞争总线控制权的问题，应当采用总线仲裁部件，以某种方式选择一个主设备优先获得总线控制权。

（总线上信息的传送是由主设备启动的，如某个主设备欲与另一个设备（从设备）进行通信时，就由总线控制器的判优、仲裁逻辑按一定的优先等级顺序，确定那个主设备使用总线。只有获得总线使用权的主设备才能开始传送数据）
```

1. 总线判优控制分类

    ```
    集中式：将控制逻辑集中在一个设备（如CPU）中，将所有的总线请求集中起来，利用一个特定的裁决算法进行裁决。
    分布式：将控制逻辑分散在与总线连接的各个部件或设备上
    ```

2. 集中式的三种优先权仲裁方式
    1. 链式查询![1583924737869](2020_Conputer_organization.assets/2020_Conputer_organization18.md)

        特点：

        ![1583924933811](2020_Conputer_organization.assets/2020_Conputer_organization19.md)

    2. 计数器定时查询方式![1583925126256](2020_Conputer_organization.assets/2020_Conputer_organization20.md)

        特点：![1583925358777](2020_Conputer_organization.assets/2020_Conputer_organization21.md)

    3. 独立请求方式![1583925495539](2020_Conputer_organization.assets/2020_Conputer_organization22.md)

        特点：![1583925536167](2020_Conputer_organization.assets/2020_Conputer_organization23.md)

    4. 集中式三种仲裁方式对比![1583925634675](2020_Conputer_organization.assets/2020_Conputer_organization24.md)

    5. 分布式仲裁

        ```
        1. 分布仲裁方式不需要中央仲裁器，每个潜在的主模块都有自己的仲裁号和仲裁器。当它们有总线请求时，就将各自的仲裁号发送到共享的仲裁总线上，再将得到的号与自已的号进行比较，如果大于自己的号，则撤消其仲裁跑不快，最后胜利者的未开发看过你保留在仲裁总线上。
        
        2. 以优先级仲裁策略为基础。
        ```

（二）、总线通信控制![1583926142930](2020_Conputer_organization.assets/2020_Conputer_organization25.md)

1. 总线通信的四种方式（重点）![1583926213319](2020_Conputer_organization.assets/2020_Conputer_organization26.md)